<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<nxthemes:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:nxthemes="http://nuxeo.org/nxthemes"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:nxl="http://nuxeo.org/nxforms/layout"
	xmlns:nxh="http://nuxeo.org/nxweb/html"
	xmlns:nxd="http://nuxeo.org/nxweb/document"
	xmlns:nxu="http://nuxeo.org/nxweb/util"
	xmlns:c="http://java.sun.com/jstl/core">

	<ui:define name="stylesheets">
		<link href="#{baseURL}/css/modepage.css" type="text/css"
			rel="stylesheet" />
	</ui:define>

	<ui:define name="header_scripts">
		<script type="text/javascript" src="#{baseURL}/scripts/icons.js"></script>
		<script type="text/javascript"
			src="#{baseURL}/tinymce/tiny_mce.js"></script>
		<script type="text/javascript"
			src="#{baseURL}/tinymce/ottc_tiny_mce_init.js"></script>
	</ui:define>

	<ui:define name="body">

			<div class="toutatice_edit_top_class">
				<div class="toutatice_edit_header_class">
					<h1>
						<h:outputText
							value="#{messages['osivia.views.create.page.title']}" />
					</h1>
				</div>

				<nxu:set var="doc"
					value="#{documentActions.getOrCreateChangeableDocument()}"
					cache="true">
					<c:choose>
						<c:when test="#{not empty doc}">
							<ui:include src="/incl/message_banner.xhtml" />

							<h:form enctype="multipart/form-data" id="document_create">

								<nxu:set var="actions"
									value="#{webActions.getActionsList('OSIVIA_CREATE_DOCUMENT_FORM')}"
									cache="true">
									<input type="hidden" name="parentDocumentPath"
										value="#{currentDocument.pathAsString}" />
									<div class="toutatice_edit_actions_class">
										<c:forEach var="action" items="#{actions}">
											<div class="savePanelAction">
												<nxh:commandButton action="#{action.getLink()}"
													immediate="#{action.immediate}" onclick="#{action.confirm}"
													id="header_edit_doc_#{action.id}"
													value="#{messages[action.label]}" class="button">

												</nxh:commandButton>
											</div>
										</c:forEach>
									</div>

									<div class="toutatice_edit_form_class">
										<div class="ttcInput">
										
											<nxl:layout name="osivia_create_document_layout" mode="create"
												value="#{doc}" />

											<h:inputHidden name="fromUrl" value="#{pageBean.fromUrl}" />
										</div>
									</div>

									<div class="toutatice_edit_actions_class">
										<c:forEach var="action" items="#{actions}">
											<div class="savePanelAction">
												<nxh:commandButton action="#{action.getLink()}"
													immediate="#{action.immediate}" onclick="#{action.confirm}"
													id="footer_edit_doc_#{action.id}"
													value="#{messages[action.label]}" class="button">

												</nxh:commandButton>
											</div>
										</c:forEach>
									</div>
								</nxu:set>

							</h:form>
						</c:when>
						<c:otherwise>
							<h1>
								<h:outputText
									value="Impossible d'afficher le formulaire de création: le type de document demandé n'est pas autorisé dans le conteneur spécifié par l'URL" />
							</h1>
						</c:otherwise>
					</c:choose>
				</nxu:set>
			</div>
			
	</ui:define>

</nxthemes:composition>