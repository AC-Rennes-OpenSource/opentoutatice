<f:subview xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
	xmlns:nxu="http://nuxeo.org/nxweb/util"
	xmlns:nxdir="http://nuxeo.org/nxdirectory"
	xmlns:nxl="http://nuxeo.org/nxforms/layout" id="#{widget.id}">
	<c:set var="isEditMode" value="#{nxl:isBoundToEditMode(layout.mode)}" />

	<script type="text/javascript">
	// FIXME: bad use of jQuery ... (cf tag 2.1.0)
	var $JQry = jQuery.noConflict();
	var $picturePath = "texte";
	var $targetPath = "texte";
	$JQry(window).load(function() {
		$picturePath = $JQry($JQry(".picturePath")[0]);
		
		if($picturePath.val()) {
			previewImg();
		}
		
		$targetPath = $JQry($JQry(".targetPath")[0]);
	});
	
	function previewImg() {
		$JQry("#imagePreview").html('<img src="' + $picturePath.val() + '"/>');
	}
	
	</script>


	<div class="titre2">
		<img src="theme/images/icone_web.gif" /><span>Image</span>
	</div>

	<c:choose>
		<c:when test="${isEditMode}">

		<nxu:dataList id="pict_fgts"
					value="#{currentDocument.pictfgt.pictureFragment}" var="pict_fgt">

	
				<s:div rendered="#{pict_fgt.refURI eq fragmentBean.uri}">
	
	
					<li><h:outputLabel value="Image* : "  />

						<h:inputText id="picturePath" class="picturePath" size="30" value="#{pict_fgt.picturePath}" />
						
							<a href="#"
								onclick="window.open('#{baseURL}editor_image_upload.faces?conversationId=#{org.jboss.seam.core.manager.currentConversationId}&amp;conversationIsLongRunning=true', '_blank','toolbar=0,location=1,directories=0,status=1,menubar=0,scrollbars=1,resizable=1,width=640,height=480'); return false;"
							
							>Rechercher une image</a>
							
							</li>
							<p id="imagePreview">
							
							</p>

					<li><h:outputLabel value="Lien : "  />
						
						<h:inputText id="targetPath" class="targetPath" size="30" value="#{pict_fgt.targetPath}" />
							<a href="#"
								onclick="window.open('#{baseURL}editor_link_search_document.faces?conversationId=#{org.jboss.seam.core.manager.currentConversationId}&amp;conversationIsLongRunning=true', '_blank','toolbar=0,location=1,directories=0,status=1,menubar=0,scrollbars=1,resizable=1,width=640,height=480'); return false;"
									
									>Rechercher un document</a>
							</li>
				</s:div>
				

			</nxu:dataList>

		</c:when>
		<c:otherwise>

    		
    	</c:otherwise>
	</c:choose>



</f:subview>
