<?xml version="1.0"?>

<component name="fr.toutatice.ecm.platform.local.publishing.notifications">

	<require>org.nuxeo.ecm.platform.notification.service.NotificationContrib
	</require>

	<extension
		target="org.nuxeo.ecm.platform.ec.notification.service.NotificationService"
		point="notifications">

		<!-- FIXME: désactivation dans les PortalSite aliors que la contrib native 
			(document routing) est: avalaibleIn=Workspace ... cependant, cette information 
			ne semble pas être utilisée (pour les autoSubscribed="true"?): getInterstedUsers 
			méthod of NotificationEventListener -->
		<notification autoSubscribed="true" availableIn="PortalSite"
			channel="email" enabled="false" label="label.nuxeo.notifications.appReviewStarted"
			name="Task assigned" subject="Task Assigned for ${docTitle}"
			template="workflowTaskAssigned"
			templateExpr="NotificationContext['taskInstance'].getVariable('taskNotificationTemplate')">
			<event name="workflowTaskAssigned" />
		</notification>

		<!-- <notification autoSubscribed="true" availableIn="PortalSite" channel="email" 
			enabled="true" name="On Line WF" subjectTemplate="onlineWorkflowSubject" 
			template="onlineWorkflow"> <event name="workflowOnlineTaskAssigned" /> <event 
			name="workflowOnlineCanceled" /> <event name="workflowOnlineTaskRejected" 
			/> <event name="workflowOnlineTaskApproved" /> </notification> -->

		<notification autoSubscribed="true" availableIn="PortalSite"
			channel="email" enabled="true" name="OnLineWFAndOther"
			subjectTemplate="onlineWorkflowAndOtherSubject"
			templateExpr="NotificationContext['taskInstance'].getVariable('taskNotificationTemplate')">
			<event name="workflowProcessCanceled" />
			<event name="workflowTaskCompleted" />
			<event name="workflowTaskRejected" />
			<event name="workflowTaskAssigned" />
		</notification>

	</extension>

	<extension
		target="org.nuxeo.ecm.platform.ec.notification.service.NotificationService"
		point="templates">

		<template name="workflow" src="templates/workflow_fr.ftl" />
		<template name="onlineWorkflow" src="templates/onlineWorkflow_fr.ftl" />
		<template name="onlineWorkflowAndOther" src="templates/onLineWFNOtherSubject_fr.ftl" />

	</extension>

</component>