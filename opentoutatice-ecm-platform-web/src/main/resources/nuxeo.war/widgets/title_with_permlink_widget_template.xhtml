<f:subview xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:nxu="http://nuxeo.org/nxweb/util"
	xmlns:nxh="http://nuxeo.org/nxweb/html"
	xmlns:nxd="http://nuxeo.org/nxweb/document"
	xmlns:c="http://java.sun.com/jstl/core">

	<h1>

		<c:if test="#{field.version}">

			<!-- Titre et version -->
			<c:if test="#{widgetProperty_localize}">
				<h:outputText value="#{messages[nxd:titleOrId(field)]}" />
       (<h:outputText value="#{messages['label.version']}" />
				<h:outputText
					value=" #{messages[documentManager.getVersionLabel(field)]}" />)
	   <h:outputText class="summary_superscript summary_publishedVersion"
					value="#{messages['label.toutatice.version.published']}"
					rendered="#{documentActions.isOnlineWithSameVersion()}" />

				<h:outputText class="summary_superscript summary_archivedVersion"
					value="#{messages['label.toutatice.version.archived']}" />
			</c:if>

			<c:if test="#{!widgetProperty_localize}">
				<h:outputText value="#{nxd:titleOrId(field)}" />
        (<h:outputText value="#{messages['label.version']}" />
				<h:outputText value=" #{documentManager.getVersionLabel(field)}" />)
        <h:outputText
					class="summary_superscript summary_publishedVersion"
					value="#{messages['label.toutatice.version.published']}"
					rendered="#{documentActions.isOnlineWithSameVersion()}" />

				<h:outputText class="summary_superscript summary_archivedVersion"
					value="#{messages['label.toutatice.version.archived']}" />
			</c:if>
		</c:if>

		<c:if test="#{! field.version}">

			<!-- Titre -->
			<c:if test="#{widgetProperty_localize}">
				<h:outputText value="#{messages[nxd:titleOrId(field)]}" />
			</c:if>
			<c:if test="#{!widgetProperty_localize}">
				<h:outputText value="#{nxd:titleOrId(field)}" />
			</c:if>

			<!-- Version -->
			<c:set var="versionLabel" value="#{documentManager.getVersionLabel(field)}" />
			<c:if test="#{!versionLabel.contains('+')}">
				<h:outputText class="summary_superscript summary_version" value="v#{versionLabel}"/>
			</c:if>
			<c:if test="#{versionLabel.contains('+')}">
				<h:outputText class="summary_superscript summary_draft" value="v#{versionLabel}" title="#{messages['label.toutatice.version.draft']}"/> 
			</c:if>

			<!-- Statut de workflow (En attente de publication, mise en ligne, validation) -->
			<c:if test="#{!documentActions.belongToPublishSpace()}">
				<nxu:set var="pendingProcess" value="#{jbpmActions.getPendingProcessName(currentDocument)}">
					<c:if test="#{not empty pendingProcess}">
						<c:set var="pendingLabel" value="label.toutatice.version.pending.#{pendingProcess}" />
						<h:outputText class="summary_superscript summary_pendingVersion" value="#{messages[pendingLabel]}" />
					</c:if>
				</nxu:set>
			</c:if>
			<c:if test="#{documentActions.belongToPublishSpace()}">
				<nxu:set var="pendingProcess" value="#{jbpmActions.getPendingProcessName(currentDocument)}">
					<c:choose>
						<c:when test="#{not empty pendingProcess}">
							<c:set var="pendingLabel"
								value="label.toutatice.version.pending.#{pendingProcess}" />
							<h:outputText class="summary_superscript summary_pendingVersion"
								value="#{messages[pendingLabel]}" />
						</c:when>
						<c:otherwise>
							<h:outputText class="summary_superscript summary_workVersion"
								value="#{messages['label.toutatice.version.work']}"
								rendered="#{!documentActions.isOnlineWithSameVersion() and !documentActions.isRemoteProxy()}" />

							<h:outputText
								class="summary_superscript summary_publishedVersion"
								value="#{messages['label.toutatice.version.published']}"
								rendered="#{documentActions.isOnlineWithSameVersion() and !documentActions.isRemoteProxy()}" />


						</c:otherwise>
					</c:choose>
				</nxu:set>
			</c:if>

			<!-- Verrou -->
			<h:outputText class="summary_superscript summary_lockedVersion"
				value="#{messages['label.toutatice.version.locked.by']} #{nxu:userFullName(currentDocumentLockDetails['document.locker'])}"
				title="#{messages['label.summary.the']} #{lockActions.getLockDetails(correntDocument).get('document.lock.time')}"
				rendered="#{!empty currentDocumentLockDetails['document.locker']}" />

		</c:if>
		<nxu:set var="actions"
			value="#{webActions.getActionsList('DOCUMENT_HEADER_ACTIONS_LIST')}"
			cache="true">

			<c:if test="#{!empty actions}">
				<c:forEach var="action" items="#{actions}">
					<c:if test="#{action.id != 'EXTENDED_TITLE'}">
						<nxh:commandLink action="#{action.getLink()}"
							onclick="#{action.confirm}" immediate="#{action.immediate}">
							<h:graphicImage value="#{action.icon}"
								rendered="#{not empty action.icon}"
								title="#{messages[action.label]}" />
						</nxh:commandLink>
					</c:if>
				</c:forEach>
			</c:if>
		</nxu:set>

		<nxu:set var="actions"
			value="#{webActions.getActionsList('DOCUMENT_HEADER_ACTIONS_LIST_HREF')}"
			cache="true">

			<c:if test="#{!empty actions}">
				<c:forEach var="action" items="#{actions}">
					<nxu:set var="link" value="#{action.getLink()}" resolveTwice="true">
						<a href="#{link}"> <h:graphicImage value="#{action.icon}"
								rendered="#{not empty action.icon}"
								title="#{messages[action.label]}" />
						</a>
					</nxu:set>
				</c:forEach>
			</c:if>
		</nxu:set>

	</h1>



</f:subview>
