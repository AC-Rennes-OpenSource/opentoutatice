<?xml version="1.0"?>
<component name="fr.toutatice.ecm.platform.core.commandline">

  <require>fr.toutatice.ecm.platform.core.commandline.executor.TTCCommandLineExecutorComponent</require>
  <require>org.nuxeo.ecm.platform.commandline.executor.service.defaultContrib</require>
  
  <extension target="fr.toutatice.ecm.platform.core.commandline.executor.TTCCommandLineExecutorComponent" point="commandTester">
  
  	<commandTester name="LibreOfficeCommandTester" 
		 	class="fr.toutatice.ecm.platform.core.commandline.executor.tester.LibreOfficeCommandTester">
    </commandTester>
    
  </extension>
  
  <extension target="fr.toutatice.ecm.platform.core.commandline.executor.TTCCommandLineExecutorComponent" point="command">

    <command name="sofficeConvertToPdf" enabled="true">
      <commandLine>soffice</commandLine>
      <parameterString> --headless --nocrashreport --nodefault --nofirststartwizard --nolockcheck --nologo --norestore -env:UserInstallation=file://#{envDirPath} --convert-to pdf --outdir #{outDirPath} #{inFilePath}</parameterString>
      <winParameterString> --headless --nocrashreport --nodefault --nofirststartwizard --nolockcheck --nologo --norestore -env:UserInstallation=file://#{envDirPath} --convert-to pdf --outdir #{outDirPath} #{inFilePath}</winParameterString>
      <tester>LibreOfficeCommandTester</tester>
      <installationDirective>You need to install soffice</installationDirective>
    </command>
    
  </extension>
  
</component>
