<f:subview xmlns:c="http://java.sun.com/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:nxl="http://nuxeo.org/nxforms/layout"
	xmlns:nxu="http://nuxeo.org/nxweb/util"
	xmlns:nxd="http://nuxeo.org/nxweb/document" id="#{layout.id}">

	<c:set var="isEditMode" value="#{nxl:isBoundToEditMode(layout.mode)}" />

	<table class="dataInput">
		<tbody>

			<nxl:layoutRow>
				<tr>
					<nxl:layoutRowWidget>

						<c:set var="colspanName" value="nxl_colspan_#{widgetIndex}" />
						<c:set var="colspan" value="#{layoutRow.properties[colspanName]}" />
						<c:set var="renderingColspan" value="#{3*colspan*layout.columns}" />
						<c:set var="renderingColspanMin" value="#{3*1*layout.columns}" />
						<c:set var="helpRenderingColspan" value="#{renderingColspan}" />
						<c:set var="labelRenderingColspan" value="#{4*renderingColspan}" />
						<c:set var="fieldRenderingColspan" value="#{5*renderingColspan}" />
						<c:set var="headerRenderingColspan" value="#{10*renderingColspan}" />

						<c:choose>

							<c:when test="${widget.type == 'studio_header'}">
								<td style="vertical-align: top;"
									colspan="#{headerRenderingColspan}"><h:outputText
										value="#{widget.label}" rendered="#{!widget.translated}"
										styleClass="#{widget.properties['styleClass']}"
										style="#{widget.properties['style']}" /> <h:outputText
										value="#{messages[widget.label]}"
										rendered="#{widget.translated}"
										styleClass="#{widget.properties['styleClass']}"
										style="#{widget.properties['style']}" /></td>
							</c:when>

							<c:otherwise>
								<c:choose>
									<c:when test="#{widget.translated}">
										<td style="vertical-align: top;"
											class="#{nxu:test(widgetIndex==0, 'iconColumn', '')}"
											colspan="#{nxu:test(widgetIndex==0, renderingColspanMin, helpRenderingColspan)}">
											<c:if test="#{!empty widget.helpLabel}">
												<h:graphicImage value="/icons/lightbulb.png"
													styleClass="layoutHelpLabel"
													title="#{messages[widget.helpLabel]}" />
											</c:if>
										</td>
										<td
											style="nxu: test(widgetIndex !=         0, 'vertical-align: top; font-weight: bold', '')"
											class="#{nxu:test(widgetIndex==0, 'labelColumn', '')}"
											colspan="#{nxu:test(widgetIndex==0, labelRenderingColspan-renderingColspanMin, labelRenderingColspan)}">
											<h:outputText value="#{messages[widget.label]}"
												style="padding-right:8px; display:block;"
												styleClass="#{nxu:test(widget.required and isEditMode, 'required', '')}" />
										</td>
									</c:when>
									<c:otherwise>
										<td style="vertical-align: top;"
											class="#{nxu:test(widgetIndex==0, 'iconColumn', '')}"
											colspan="#{nxu:test(widgetIndex==0, renderingColspanMin, helpRenderingColspan)}">
											<c:if test="#{!empty widget.helpLabel}">
												<h:graphicImage value="/icons/lightbulb.png"
													styleClass="layoutHelpLabel" title="#{widget.helpLabel}" />
											</c:if>
										</td>
										<td
											style="nxu: test(widgetIndex !=         0, 'vertical-align: top; font-weight: bold', '')"
											class="#{nxu:test(widgetIndex==0, 'labelColumn', '')}"
											colspan="#{nxu:test(widgetIndex==0, labelRenderingColspan-renderingColspanMin, labelRenderingColspan)}">
											<h:outputText value="#{widget.label}"
												style="padding-right:8px; display:block;"
												styleClass="#{nxu:test(widget.required and isEditMode, 'required', '')}" />
										</td>
									</c:otherwise>
								</c:choose>
								<td style="vertical-align: top;"
									colspan="#{fieldRenderingColspan}"><nxl:widget
										widget="#{widget}" value="#{value}" /></td>
							</c:otherwise>

						</c:choose>
					</nxl:layoutRowWidget>
				</tr>
			</nxl:layoutRow>

		</tbody>
	</table>


	<script>
		jQuery(document).ready(function() {
			jQuery("img.layoutHelpLabel[title]").tooltip({
				delay : 1000,
				predelay : 250,
				offset : [ 0, 100 ],
				position : 'center center'
			});
		});
	</script>

</f:subview>